
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Ogani Template">
    <meta name="keywords" content="Ogani, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ogani | Template</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet">

<!-- Css Styles -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/font-awesome.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/elegant-icons.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/nice-select.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/jquery-ui.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/owl.carousel.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/slicknav.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" type="text/css">

</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>

<!-- Humberger Begin -->
    <div class="humberger__menu__overlay"></div>
    <div class="humberger__menu__wrapper">
        <div class="humberger__menu__logo">
            <a href="#"><img src="img/logo.png" alt=""></a>
        </div>
        <div class="humberger__menu__cart">
            <ul>
                <li><a href="#"><i class="fa fa-heart"></i> <span>1</span></a></li>
                <li><a href="#"><i class="fa fa-shopping-bag"></i> <span>3</span></a></li>
            </ul>
            <div class="header__cart__price">item: <span>$150.00</span></div>
        </div>
        <div class="humberger__menu__widget">
            <div class="header__top__right__language">
                <img src="img/language.png" alt="">
                <div>English</div>
                <span class="arrow_carrot-down"></span>
                <ul>
                    <li><a href="#">Spanis</a></li>
                    <li><a href="#">English</a></li>
                </ul>
            </div>
            <div class="header__top__right__auth">
                <a href="#"><i class="fa fa-user"></i> Login</a>
            </div>
        </div>
        <nav class="humberger__menu__nav mobile-menu">
            <ul>
                <li class="active"><a href="./index.html">Trang ch·ªß</a></li>
                <li><a href="{{ url_for('shop_grid') }}">C·ª≠a h√†ng</a></li>
                <li><a href="#">Pages</a>
                    <ul class="header__menu__dropdown">
                        <li><a href="./shop-details.html">Shop Details</a></li>
                        <li><a href="./shoping-cart.html">Shoping Cart</a></li>
                        <li><a href="./checkout.html">Check Out</a></li>
                        <li><a href="./blog-details.html">Blog Details</a></li>
                    </ul>
                </li>
                <li><a href="{{ url_for('blog') }}"></a></li>
                <li><a href="./contact.html">Li√™n h·ªá</a></li>
            </ul>
        </nav>
        <div id="mobile-menu-wrap"></div>
        <div class="header__top__right__social">
            <a href="#"><i class="fa fa-facebook"></i></a>
            <a href="#"><i class="fa fa-twitter"></i></a>
            <a href="#"><i class="fa fa-linkedin"></i></a>
            <a href="#"><i class="fa fa-pinterest-p"></i></a>
        </div>
        <div class="humberger__menu__contact">
            <ul>
                <li><i class="fa fa-envelope"></i> hello@colorlib.com</li>
                <li>Free Shipping for all Order of $99</li>
            </ul>
        </div>
    </div>
    
    <header class="header">
        <div class="header__top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <div class="header__top__left">
                          <div id="headerContainer">
    <!-- N·ªôi dung s·∫Ω ƒë∆∞·ª£c load v√†o ƒë√¢y -->
                        </div>

                        <script>
                        fetch('/header')
                            .then(res => {
                            if (!res.ok) throw new Error('Ch∆∞a ƒëƒÉng nh·∫≠p ho·∫∑c l·ªói server');
                            return res.text();
                            })
                            .then(html => {
                            document.getElementById('headerContainer').innerHTML = html;
                            })
                            .catch(err => {
                            console.error(err);
                            document.getElementById('headerContainer').innerHTML = "<p>Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ xem th√¥ng tin.</p>";
                            });
                        </script>
                       </div>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="header__top__right">
                            <div class="header__top__right__social">
                                <a href="#"><i class="fa fa-facebook"></i></a>
                                <a href="#"><i class="fa fa-twitter"></i></a>
                                <a href="#"><i class="fa fa-linkedin"></i></a>
                                <a href="#"><i class="fa fa-pinterest-p"></i></a>
                            </div>
                            <div class="header__top__right__language">
                                <img src="img/language.png" alt="">
                                <div>English</div>
                                <span class="arrow_carrot-down"></span>
                                <ul>
                                    <li><a href="#">Spanis</a></li>
                                    <li><a href="#">English</a></li>
                                </ul>
                            </div>
                            <div class="header__top__right__auth">
      <button type="button" class="btn btn-primary" id="btnRegister">ƒêƒÉng k√Ω</button>

   <button type="button" class="btn btn-primary" id="btnLogin">ƒêƒÉng nh·∫≠p</button>
<button id="btnLogout" class="btn btn-danger">ƒêƒÉng xu·∫•t</button>

<script>
  document.getElementById('btnLogout').addEventListener('click', function() {
    fetch('/logout')
      .then(response => response.text())
      .then(message => {
        alert(message); // Hi·ªÉn th·ªã th√¥ng b√°o "B·∫°n ƒë√£ ƒëƒÉng xu·∫•t."
        location.reload(); // Load l·∫°i trang hi·ªán t·∫°i
      })
      .catch(() => alert('L·ªói khi ƒëƒÉng xu·∫•t'));
  });
</script>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="header__logo">
                        <a href="./index.html"><img src="img/logo.png" alt=""></a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <nav class="header__menu">
                        <ul>
                            <li class="active"><a href="{{ url_for('home') }}">Trang ch·ªß</a></li>
                           <li><a href="{{ url_for('shop_grid') }}">C·ª≠a h√†ng</a></li>
                    
                                <li><a href="{{ url_for('blog') }}">Tin T·ª©c</a></li>
                             <li><a href="{{ url_for('contact') }}">Li√™n h·ªá</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-lg-3">
                    <div class="header__cart">
                        <ul>
                          <a href="/saved-products">üß°</a>

                            <li><a href="#"><i class="fa fa-shopping-bag"></i> <span>3</span></a></li>
                        </ul>
                        <div class="header__cart__price">item: <span>$150.00</span></div>
                    </div>
                </div>
            </div>
            <div class="humberger__open">
                <i class="fa fa-bars"></i>
            </div>
        </div>
    </header>
<content>
    <div id="registerContainer" class="mt-4"></div>

<script>
let isSubmitting = false;

function loadRegisterForm() {
    isSubmitting = false; // reset khi m·ªü form m·ªõi
    fetch('/register')
        .then(res => res.text())
        .then(html => {
            document.getElementById('registerContainer').innerHTML = html;
        });
}

function submitRegisterForm(event) {
    event.preventDefault();
    console.log('submitRegisterForm called');
    if (isSubmitting) return;
    isSubmitting = true;

    const form = event.target;
    const formData = new FormData(form);

    fetch('/register', {
        method: 'POST',
        body: formData
    })
    .then(res => res.json())
    .then(data => {
        const msgBox = document.getElementById('registerMessage');
        msgBox.textContent = data.message;
        msgBox.className = data.status === 'success' ? 'alert alert-success' : 'alert alert-danger';

        if (data.status === 'success') {
            form.reset();
            setTimeout(() => location.reload(), 1000);
        } else {
            isSubmitting = false;
        }
    })
    .catch(() => {
        isSubmitting = false;
    });
}

document.getElementById('btnRegister').addEventListener('click', loadRegisterForm);

document.getElementById('registerContainer').addEventListener('submit', function(event) {
    if (event.target && event.target.matches('form#registerForm')) {
        submitRegisterForm(event);
    }
});
</script>

</content>
<content>
    <div id="loginContainer"></div>

    <script>
        
        const btnLogin = document.getElementById('btnLogin');
        const loginContainer = document.getElementById('loginContainer');

        document.getElementById('btnLogin').addEventListener('click', () => {
            fetch('/login')
                .then(res => res.text())
                .then(html => {
                    document.getElementById('loginContainer').innerHTML = html;
                });
        });


        btnLogin.addEventListener('click', () => {
            fetch('/login')
                .then(res => res.text())
                .then(html => {
                    loginContainer.innerHTML = html;
                    loginContainer.style.display = 'flex';

                    // G·∫Øn s·ª± ki·ªán n√∫t h·ªßy trong form
                    const cancelBtn = loginContainer.querySelector('#cancelBtn');
                    if(cancelBtn){
                        cancelBtn.addEventListener('click', () => {
                            loginContainer.style.display = 'none';
                            loginContainer.innerHTML = '';
                        });
                    }

                    // G·∫Øn s·ª± ki·ªán submit form
                    const loginForm = loginContainer.querySelector('#loginForm');
                    if(loginForm){
                        loginForm.addEventListener('submit', async (e) => {
                            e.preventDefault();
                            const formData = new FormData(loginForm);

                            try {
                                const response = await fetch('/login', {
                                    method: 'POST',
                                    body: formData
                                });
                                const data = await response.json();

                                const msgBox = loginContainer.querySelector('#loginMessage');
                                msgBox.textContent = data.message;
                                msgBox.className = data.status === 'success' ? 'alert alert-success' : 'alert alert-danger';

                                if(data.status === 'success'){
                                    setTimeout(() => {
                                        location.reload();
                                    }, 1000);
                                }
                            } catch {
                                alert('L·ªói k·∫øt n·ªëi server');
                            }
                        });
                    }
                });
        });
    </script>
</content>
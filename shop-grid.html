<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Ogani Template">
    <meta name="keywords" content="Ogani, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ogani | Template</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet">

    <!-- Css Styles -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/font-awesome.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/elegant-icons.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/nice-select.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/jquery-ui.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/owl.carousel.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/slicknav.min.css') }}" type="text/css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" type="text/css">

</head>
<style>
    .product__pagination a {
  display: inline-block;
  padding: 6px 12px;
  margin: 0 4px;
  text-decoration: none;
  color: #333;
  border: 1px solid transparent;
  border-radius: 4px;
  transition: background-color 0.3s, color 0.3s;
}

.product__pagination a:hover {
  background-color: #eee;
}

.product__pagination a.active {
  background-color: #f7941d; /* Màu nền của trang hiện tại */
  color: white;             /* Màu chữ */
  border-color: #f7941d;
  font-weight: bold;
}

</style>
<body>
  {% include 'header.html' %}
    <!-- Header Section End -->

    <!-- Hero Section Begin -->
    <section class="hero hero-normal">
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="hero__categories">
                        <div class="hero__categories__all">
                            <i class="fa fa-bars"></i>
                            <span>DANH MỤC</span>
                        </div>
                        <ul>
                        
                        </ul>
                    </div>
                </div>
                <div class="col-lg-9">
                    <div class="hero__search">
                        <div class="hero__search__form">
                            <form action="#">
                                <div class="hero__search__categories">
                                   LOẠI HÀNG
                                    <span class="arrow_carrot-down"></span>
                                </div>
                                <input type="text" placeholder="What do yo u need?">
                                <button type="submit" class="site-btn">TÌM KIẾM</button>
                            </form>
                        </div>
                        <div class="hero__search__phone">
                            <div class="hero__search__phone__icon">
                                <i class="fa fa-phone"></i>
                            </div>
                            <div class="hero__search__phone__text">
                                <h5>+0921790266</h5>
                                <span>Hỗ trợ 24/7 t</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Hero Section End -->
   {% include '_chatbot_widget.html' %}
    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-section set-bg" data-setbg="{{ url_for('static', filename='img/banner/banner.jpg') }}">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="breadcrumb__text">
                        <h2>Organi Shop</h2>
                        <div class="breadcrumb__option">
                            <a href="./index.html">Trang chủ</a>
                            <span>Cửa hàng</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

    <!-- Product Section Begin -->
    <section class="product spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-5">
                    <div class="sidebar">
                        <div class="sidebar__item">
                            <h4>Nhãn hàng</h4>
                             <ul>
                                {% for b in brands[:10] %}
                    <li>{{ b }}</li>
                {% endfor %}
                        </div>
                        <div class="sidebar__item">
                            <h4>Giá</h4>
                            <div class="price-range-wrap">
                                <div class="price-range ui-slider ui-corner-all ui-slider-horizontal ui-widget ui-widget-content"
                                    data-min="10" data-max="540">
                                    <div class="ui-slider-range ui-corner-all ui-widget-header"></div>
                                    <span tabindex="0" class="ui-slider-handle ui-corner-all ui-state-default"></span>
                                    <span tabindex="0" class="ui-slider-handle ui-corner-all ui-state-default"></span>
                                </div>
                                <div class="range-slider">
                                    <div class="price-input">
                                        <input type="text" id="minamount">
                                        <input type="text" id="maxamount">
                                    </div>
                                </div>
                            </div>
                        </div>

                      
                        <div class="sidebar__item">
                            <div class="latest-product__text">
                                <h4>Sản phẩm gợi ý</h4>
                               <div class="latest-product__slider owl-carousel">
                                    {% for chunk in products|batch(3, '') %}
                                    <div class="latest-prdouct__slider__item">
                                        {% for product in chunk %}
                                        {% if product %}
                                        <a href="{{ url_for('product_detail', product_id=product.product_id) }}" class="latest-product__item">
                                            <div class="latest-product__item__pic">
                                                <img src="{{ product.image_url or url_for('static', filename='img/default.jpg') }}" alt="{{ product.name }}">
                                            </div>
                                            <div class="latest-product__item__text">
                                                <h6>{{ product.name }}</h6>
                                                <span>${{ '%.2f' | format(product.price) }}</span>
                                            </div>
                                        </a>
                                        {% endif %}
                                        {% endfor %}
                                    </div>
                                    {% endfor %}
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-9 col-md-7">
                    <div class="product__discount">
                        <div class="section-title product__discount__title">
                            <h2>Sale Off</h2>
                        </div>
                      <div class="row">
                    <div class="product__discount__slider owl-carousel">
                        {% for product in products[:6] %}
                        <div class="col-lg-4">
                            <div class="product__discount__item">
                               <div class="product__discount__item__pic set-bg">
    <img src="{{ product.image_url or url_for('static', filename='img/default.jpg') }}" alt="{{ product.name }}">


                                    {% if product.discount %}
                                    <div class="product__discount__percent">-{{ product.discount }}%</div>
                                    {% endif %}
                                    <ul class="product__item__pic__hover">
                                        <li><a href="#"><i class="fa fa-heart"></i></a></li>
                                        <li><a href="#"><i class="fa fa-retweet"></i></a></li>
                                        <li><a href="#"><i class="fa fa-shopping-cart"></i></a></li>
                                    </ul>
                                </div>
                                <div class="product__discount__item__text">
                                    <span>{{ product.category or 'No Category' }}</span>
                                    <h5><a href="{{ url_for('product_detail', product_id=product.product_id) }}">{{ product.name }}</a></h5>
                                    <div class="product__item__price">
                                        ${{ '%.2f' | format(product.price) }}
                                        {% if product.original_price and product.original_price > product.price %}
                                        <span>${{ '%.2f' | format(product.original_price) }}</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    </div>

                    </div>
                  <div class="filter__item">
    <div class="row">
        <div class="col-lg-4 col-md-5">
            <div class="filter__sort">
                <span>Lọc</span>
                <select>
                    <option value="default">Mặc định</option>
                    <!-- Bạn có thể thêm option khác tùy ý -->
                </select>
            </div>
        </div>
        <div class="col-lg-4 col-md-4">
            <div class="filter__found">
                <h6><span>{{ total_products }}</span> Tìm thấy sản phẩm</h6>
            </div>
        </div>
        <div class="col-lg-4 col-md-3">
            <div class="filter__option">
                <span class="icon_grid-2x2"></span>
                <span class="icon_ul"></span>
            </div>
        </div>
    </div>
</div>

<div class="row">
    {% for product in products %}
    <div class="col-lg-4 col-md-6 col-sm-6">
        <div class="product__item">
           <div class="product__item__pic set-bg">
    <img src="{{ product.image_url or url_for('static', filename='img/default.jpg') }}" alt="{{ product.name }}">
                <ul class="product__item__pic__hover">
                 <li>
  <button type="button" class="save-btn" data-product-id="{{ product['product_id'] }}" style="background: none; border: none; cursor: pointer;">
    <i class="fa fa-heart"></i>
  </button>
</li>
<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.save-btn').forEach(button => {
    button.addEventListener('click', function handler(e) {
      e.preventDefault(); // Ngăn hành động mặc định (nếu là nút submit)

      const btn = this;
      const productId = btn.getAttribute('data-product-id');

      fetch(`/save-product/${productId}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-Requested-With': 'XMLHttpRequest'
        }
      })
      .then(response => response.json())
      .then(data => {
        if (data.status === 'success') {
          // Không hiện alert
          btn.disabled = true; // disable nút
          btn.innerHTML = '<i class="fa fa-check"></i> Đã lưu'; // thay text/icon
          btn.removeEventListener('click', handler); // bỏ event listener
        } else {
          // Có thể thêm xử lý lỗi nhẹ nhàng ở đây, ví dụ đổi màu nút hoặc hiển thị text lỗi
          // Nhưng không hiện alert theo yêu cầu
          console.error('Lỗi: ' + data.message);
        }
      })
      .catch(error => {
        // Xử lý lỗi fetch
        console.error('Lỗi mạng hoặc server:', error);
      });
    });
  });
});
</script>


                    <li><a href="#"><i class="fa fa-retweet"></i></a></li>
                    <li><a href="#"><i class="fa fa-shopping-cart"></i></a></li>
                </ul>
            </div>
            <div class="product__item__text">
                <h6><a href="{{ url_for('product_detail', product_id=product.product_id) }}">{{ product.name }}</a></h6>
                <h5>${{ '%.2f' | format(product.price) }}</h5>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<div class="product__pagination">
    {% if page > 1 %}
    <a href="{{ url_for('shop_grid', page=page-1) }}"><i class="fa fa-long-arrow-left"></i></a>
    {% endif %}

    {% for p in range(1, total_pages + 1) %}
    <a href="{{ url_for('shop_grid', page=p) }}" class="{{ 'active' if p == page else '' }}">{{ p }}</a>
    {% endfor %}

    {% if page < total_pages %}
    <a href="{{ url_for('shop_grid', page=page+1) }}"><i class="fa fa-long-arrow-right"></i></a>
    {% endif %}
</div>

                </div>
            </div>
        </div>
    </section>
    <!-- Product Section End -->
     {% include 'footer.html' %}
    <!-- Footer Section Begin -->
    
    <!-- Footer Section End -->

    <!-- Js Plugins -->
<script src="{{ url_for('static', filename='js/jquery-3.3.1.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.nice-select.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery-ui.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.slicknav.js') }}"></script>
<script src="{{ url_for('static', filename='js/mixitup.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/owl.carousel.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>




</body>

</html>